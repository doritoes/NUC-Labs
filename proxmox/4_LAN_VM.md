# Install LAN  VM
Next we will install our first VM(s). These are on the Inside/LAN network, located behind our VyOS router. Instructions are provided for a few different systems you might want to install.

NOTE You will need to upload/copy the appropriate ISO file to one of the SR's (storage repositories) configured earlier

IMPORTANT Currently the VyOS router is using NAT to access the outside world. This means that the rest of the hosts in my Lab can't get to the 192.168.100.0/24 network. Buuut the inside network 192.168.100.0/24 can reach the Internet and the rest of my Lab network (NAS, printer, etc).

# Ubuntu Desktop
NOTE Ubuntu 22.04 Desktop runs on less vCPU and RAM requirements. 1vCPU 2GB RAM, 20GB disk installs and runs without problem.
- From the top ribbon click **Create VM**
  - General tab
    - Node: **proxmox-lab**
    - VM ID: *auto populates* (unique ID required for every resource)
    - Name: **ubuntu-desktop-lan**
  - OS tab
    - Storage: *select one of the ISO storage units you created*
    - ISO image: *search and/or select the Ubuntu 24.04 desktop ISO from dropdown*
    - Guest OS:
      - Type: Linux
      - Version: 6x - 2.6 Kernel
  - System tab
    - No changes required
  - Disks tab
    - Disk size: **25GB** (25GB is the recommended minimum)
    - Check **Discard** because our host uses SSDs
  - CPU tab
    - Sockets: 1
    - Cores: 2 (1 is minimum, but in lab testing 2 was required to install successfully)
    - Type: default (my Lab is x86-64-v2-AES)
  - Memory tab
    - **4096 MB** (4GB recommended, technically can run on 2GB RAM; in lab testing, 4 was required to install successfully; some users say 3 is fine for a VM)
  - Network tab
    - Bridge: **vmbr1**
  - Confirm tab
    - Check **Start after created**
    - Click **Finish**
- From the left menu navigate to the new VM
  - Datacenter > proxmox-lab > 101 (ubuntu-desktop-lan)
  - Click on the VM in the left menu
- Click the **Console** button along the top of the pane to open a separate window for the console
- Follow the Install wizard per usual
  - NOTE installation seemed to freeze at "Copying files" with less that 2 vCPUs, 4GB RAM; seemed OK with only 20GB storage
  - To remove the installation media
    - Back in the main proxmox window, click on the VM, then click Hardware
    - Edit the CD/DVD Drive
      - Do not use any media
  - Press Enter to Reboot
- Log in to the console and complete the first time wizard
  - Next, Skip, No, Next, Finish
- Updates
  - Optionally let the Software Updater "Install Now"
  - Or do a manual update
    - `sudo apt update && sudo apt upgrade -y && sudo apt autoremove -y`
  - reboot
- Test the VM
  - Internet access using Firefox
- Configure sharing your desktop
  - NOTE See https://askubuntu.com/questions/1482111/remote-desktop-ubuntu-22-04-lts for older Ubuntu version
  - Settings > System > Remote Desktop
  - Enable the Desktop Sharing slider
  - Enable Remote Control slider
  - Under authentication, confirm the username <ins>and password</ins>
    - a random password is set; you might want to change it to something more memorable  
  - BEWARE that remote desktop is disabled when the screen is locked
    - see https://askubuntu.com/questions/1411504/connect-when-remote-desktop-is-on-login-screen-or-screen-locked-without-autolog
    - there are workarounds
- Enable SSH access
  - `sudo apt install -y openssh-server`
  - `sudo systemctl enable --now ssh`
  - `systemctl status ssh`
  - To secure it further (enable ufw firewall, etc.) see https://serverastra.com/docs/Tutorials/Setting-Up-and-Securing-SSH-on-Ubuntu-22.04%3A-A-Comprehensive-Guide
- Install qemu-guest-agent
  - https://pve.proxmox.com/wiki/Qemu-guest-agent
  - First, install the agent
    - `sudo apt update && sudo apt install -y qemu-guest-agent`
  - Second, enable the agent in proxmox
    - Click on the VM
    - Click on Options
    - Edit QEMU Guest Agent: Check **Use QEMU Guest Agent**
    - Click **OK**
  - Third, Stop and Start the VM (a "restart" or "reboot" is not enough)
    - Confirm it's running: `systemctl status qemu-guest-agent`
- Power down the VM
- Take a Snapshot
  - This is to demonstrate how to take a snapshot and what happens to snapshots when you convert a VM to a template
  - Click on the VM in the left pane
  - Click **Snapshots**
  - Click **Take Snapshot**
    - Name: **initial_build** (no spaces)
  - Home > VMs
  -   - Click the small X to remove the filter, showing ALL VMs including those shut down
  - Click `ubuntu-desktop-lan`
  - Click the Snapshots tab
  - Click **New snapshot**
- Convert to a Template
  - Click on the VM
  - Click **More** > **Convert to template** (next to start, shutdown, and console)
    - Click **Yes**
    - Read the warning: **unable to create template, because VM contains snapshots**
    - Snapshots > click `initial_build` > Remove > **Yes**
    - Repeat the action to convert to template
    - Read the warning: **you can't convert a VM to template if VM is running (500)**
    - Shut down the VM, then repeat the action to convert to template
  - Note that the VM is still there, but as a template it <ins>can only be cloned</ins>
- Clone a new VM from `ubuntu-desktop-lan`
  - Click on the VM ubuntu-desktop-lab (it should still be powered off)
  - Click More > Clone
    - Target node: **proxmox-lab**
    - VM ID: *automatically populated*
    - Mode: **Linked Clone** is recommeded (saves space across all the clones)
      - the other option is Full Clone
    - Name: `desktop-lan`
    - Click **Clone**
- Power on and test the new clone (desktop-lan)
  - Click on the new VM **desktop-lan**
  - Click **Start**
  - Click **Console**
  - Change hostname from terminal
    - View current hostname: `hostnamectl`
    - Set the new hostname: `sudo hostnamectl set-hostname desktop-lan`
    - Optionally set the pretty name: `sudo hostnamectl set-hostname "Ubuntu Desktop on LAN" --pretty`
    - Confirm it has changed: `hostnamectl`
- Optionally create another clone and experiment
- What are the advantages of using DHCP in the lab for these closes and templates?

# Ubuntu Server
- From the top ribbon click **Create VM**
  - General tab
    - Node: **proxmox-lab**
    - VM ID: *auto populates* (unique ID required for every resource)
    - Name: **ubuntu-server-lan**
  - OS tab
    - Storage: *select one of the ISO storage units you created*
    - ISO image: *search and/or select the Ubuntu 24.04 server ISO from dropdown*
    - Guest OS:
      - Type: Linux
      - Version: 6x - 2.6 Kernel
  - System tab
    - No changes
  - Disks tab
    - Disk size: **20GB**
    - Check **Discard** because our host uses SSDs
  - CPU tab
    - Sockets: **1**
    - Cores: **1**
    - Type: default (my Lab is x86-64-v2-AES)
  - Memory tab
    - **2048 MB** (2GB)
  - Network tab
    - Bridge: **vmbr1**
  - Confirm tab
    - Check **Start after created**
    - Click **Finish**
- From the left menu navigate to the new VM
  - Datacenter > proxmox-lab > 103 (ubuntu-server-lan)
  - Click on the VM in the left menu
- Click the **Console** button along the top of the pane
  - a separate window is opened
- Click the Console tab and follow the Install wizard per usual
  - READ CAREFULLY the Guided storage configuration
    - Root / only has **10GB** of the **20GB** allocated
    - Solutions (if in doubt, use Option 1; Option 2 is popular for /var, /var/log, /opt, or /home)
      - Option 1 expand root /
        - Under used devices, locate ubuntu-lv which will be mounted at root /
        - Select it, and then Edit
        - Change the Size to the max value
      - Option 2
        - Select the free space, then Create Logical Volume
        - Adjust the size to use the free space
        - Adjust the mount point (/home by default)
    - Choose Create
  - Recommend checking the box Install OpenSSH server
  - To remove the installation media
    - Back in the main proxmox window, click on the VM, then click Hardware
    - Edit the CD/DVD Drive
      - Set to "Do not use any media"
  - Press Enter to Reboot
- Log in and check the system using Console
  - Is the disk size correct? `df -h`
- Test the VM
  - Updates
    - `sudo apt update && sudo apt upgrade -y && sudo apt autoremove -y`
    - accept the messages (default values OK)
- Install qemu-guest-agent
  - https://pve.proxmox.com/wiki/Qemu-guest-agent
  - First, install the agent
    - `sudo apt update && sudo apt install -y qemu-guest-agent`
  - Second, enable the agent in proxmox
    - Click on the VM
    - Click on Options
    - Edit QEMU Guest Agent: Check Use QEMU Guest Agent
    - Click OK
  - Third, Stop and Start the VM (a "restart" or "reboot" is not enough)
    - Confirm it's running: `systemctl status qemu-guest-agent`
- Power down the VM
  - `sudo poweroff`
- Convert to a Template
  - Click on the VM
  - Click **More** > **Convert to template** (next to start, shutdown, and console)
    - Click **Yes**
    - Note that the VM is still there, but as a template it <ins>can only be cloned</ins>
- Clone a new VM from `ubuntu-server-lan`
  - Click on the VM ubuntu-server-lan (it should still be powered off)
  - Click More > Clone
    - Target node: **proxmox-lab**
    - VM ID: *automatically populated**
    - Mode: **Linked Clone** is recommeded (saves space across all the clones)
      - the other option is Full Clone
    - Name: `server-lan`
    - Click **Clone**
- Power on and test the new clone (server-lan)
  - Click on the new VM **server-lan**
  - Click **Start**
  - Click **Console**
  - Change hostname
    - View current hostname: `hostnamectl`
    - Set the new hostname: `sudo hostnamectl set-hostname server-lan`
    - Optionally set the pretty name: `sudo hostnamectl set-hostname "Ubuntu Server on LAN" --pretty`
    - Confirm it has changed: `hostnamectl`
  - How could you use cloning to quickly roll out a number of servers of the same type?

# Windows 10
- From the top ribbon click **Create VM**
  - General tab
    - Node: **proxmox-lab**
    - VM ID: *auto populates* (unique ID required for every resource)
    - Name: **win10-lan**
  - OS tab
    - Storage: *select one of the ISO storage units you created*
    - ISO image: *search and/or select the Windows 10 ISO from dropdown*
    - Guest OS:
      - Type: **Microsoft Windows**
      - Version: **10/2016/2019**
        - the most recent option is *11/2022/2025*
  - System tab
    - No changes
  - Disks tab
    - Disk size: **128GB**
    - Check **Discard** because our host uses SSDs
  - CPU tab
    - Sockets: 1
    - Cores: 2
    - Type: default (my Lab is x86-64-v2-AES)
  - Memory tab
    - **4096 MB** (4GB)
  - Network tab
    - Bridge: **vmbr1**
  - Confirm tab
    - Check **Start after created**
    - Click **Finish**
- From the left menu navigate to the new VM
  - Datacenter > proxmox-lab > 105 (win10-lan)
  - Click on the VM in the left menu
- Click the **Console** button along the top of the pane
  - a separate window is opened
- Click Console and follow the Install wizard per usual
  - Confirm Language, formats, and keyboard then Next
  - Click **Install now**
  - Activate Windows: Click **I don't have a product key**
  - Select the OS to install: **Windows 10 Pro** (feel free to experiment) and click **Next**
  - Check the box then click **Next**
  - Click **Custom: Install Windows only (advanced)**
  - Accept the installation on Drive 0, click **Next**
  - Wait while the system powers reboots and gradually installs
- When the system boots to "Let's start with region. Is this right?"
  - Remove the installation media
    - Back in the main proxmox window, click on the VM, then click Hardware
    - Edit the CD/DVD Drive
      - Do not use any media
  - At the console, press **Shift-F10** to open command prompt
    - `shutdown /t 0 /s`
    - type this exactly, spacing matters
- Clone a new VM from `win10-lan`
  - Click on the VM win10-lan
  - Click More > Clone
    - Target node: **proxmox-lab**
    - VM ID: *automatically populated** (we are up to VM ID 106)
    - NOTE There is no "Linked Clone" option
    - Name: `win10-lan-ready`
    - Click **Clone**  
  - Log in complete the setup wizard
    - Start the VM 106 (win10-lan-ready)
    - Open the Console
    - Set region and keyboard layout, skip second keyboard layout
    - Select **Set up for personal use** (feel free to experiment)
    - Click **Offline account** then click **Limited experience**
    - User: **lab**
    - Password: *select a password*
    - Create security questions for this account: be creative
    - Click **Not now**
    - Privacy: *disable all the settings* and then click **Accept**
    - Experience: be creative and pick one, then click **Accept* (I chose Business)
    - Cortana: Click **Not now**
    - Open the Edge web browser
    - At the screen "Browse the web with the best performing browser on Windows"
      - Click **Continue**
      - Click **Start without your data**
      - <ins>Uncheck</ins> Bring over your data and **Confirm and continue**
      - Click **Continue without this data**
      - <ins>Uncheck</ins> Make your Microsoft experience more useful and **Confirm and start browsing**
      - Click **Finish**
- Apply Windows Updates (reboots included)
- Enable Remote Desktop (RDP)
  - Start > Settings > System > Remote Desktop
  - Slide to enable and Confirm
- [Install QEMU Guest Agent](Appendix_Install_Guest_Agent_Windows.md)
- Change the hostname to win-10-lan-ready
  - From administrative powershell: `Rename-Computer -NewName win10-lan-ready`
- Shut down the Windows VM
- Convert to a Template
  - Click on the VM
  - Click **More** > **Convert to template** (next to start, shutdown, and console)
    - Click **Yes**
    - Note that the VM is still there, but as a template it <ins>can only be cloned</ins>
- Clone a new VM from `win10-lan-ready`
  - Click on 106 (win10-lan-ready)
  - Click More > Clone
    - Target node: **proxmox-lab**
    - VM ID: *automatically populated**
    - Mode: **Linked Clone** is recommeded (saves space across all the clones)
      - the other option is Full Clone
    - Name: `win10-desk`
    - Click **Clone**
- Power on and test the new clone VM 107 (win10-desk)
  - Click on the new VM **win10-desk**
  - Click **Start**
  - Click **Console**
  - Change the hostname to win10-desk
    - From administrative powershell: `Rename-Computer -NewName win10-desk`
    - `Restart-Computer`

- Questions to ponder:
  - What are the differences between the two cloning bases we created?
  - Does this affect the "Activation required" timers?
- Optionally create another VM from each win10-lan and win10-lan-ready and experiment

# Windows 11
IMPORTANT Windows 11 will not install without a TPM.

IMPORTANT If you want to set up using a local account instead of a Microsoft account
- Disconnect Internet during setup
- https://www.elevenforum.com/t/clean-install-windows-11.99/
  - The alternate method provided (Shift-F10 and enter OOBE\BYPASSNRO) didn't work in Lab testing

Steps:
- From the top ribbon click **Create VM**
  - General tab
    - Node: **proxmox-lab**
    - VM ID: *auto populates* (unique ID required for every resource, up to VM 108)
    - Name: **win11-lan**
  - OS tab
    - Storage: *select one of the ISO storage units you created*
    - ISO image: *search and/or select the Windows 10 ISO from dropdown*
    - Guest OS:
      - Type: **Microsoft Windows**
      - Version: **11/2022/2025**
  - System tab
    - Check **Add TPM**
    - TPM Storage: select **local-lvm**
    - EFI Storage: select **local-lvm**
  - Disks tab
    - Disk size: **128GB**
    - Check **Discard** because our host uses SSDs
  - CPU tab
    - Sockets: 1
    - Cores: 2
    - Type: default (my Lab is x86-64-v2-AES)
  - Memory tab
    - **4096 MB** (4GB)
  - Network tab
    - Bridge: **vmbr1**
  - Confirm tab
    - Check **Start after created**
    - Click **Finish**
- From the left menu navigate to the new VM
  - Datacenter > proxmox-lab > 108 (win11-lan)
  - Click on the VM in the left menu
- Click the **Console** button along the top of the pane
  - a separate windows is opened
- You are prompted **Press any key to boot from CD or DVD....**
  - **press any key**
  - if you missed it, stop the VM, start again and try again at the console
- Click Console and follow the Install wizard per usual
  - Confirm Language, formats, and keyboard then Next
  - Click **Install now**
  - Activate Windows: Click **I don't have a product key**
  - Select the OS to install: **Windows 11 Pro** (feel free to experiment) and click **Next**
  - Check the box then click **Next**
  - Click **Custom: Install Windows only (advanced)**
  - Accept the installation on Drive 0, click **Next**
  - Wait while the system powers reboots and gradually installs
- When the system boots to "Let's start with region. Is this right?"
  - Remove the installation media
    - Back in the main proxmox window, click on the VM, then click Hardware
    - Edit the CD/DVD Drive
      - Do not use any media
  - At the console, press **Shift-F10** to open command prompt
    - `shutdown /t 0 /s`
    - type this exactly, spacing matters
- Clone a new VM from `win11-lan`
  - Click on the VM win11-lan (it should still be powered off)
  - Click More > Clone
    - Target node: **proxmox-lab**
    - VM ID: *automatically populated** (now up to 109)
    - NOTE There is no "Linked Clone" option
    - Name: `win11-lan-ready`
    - Click **Clone**  
  - Log in complete the setup wizard
    - Start the VM
      - If you don't want to create a Microsoft account during setup, it's convenient to disable the Internet connect (as simple as powering down the VyOS router for now)
    - Set region and keyboard layout, skip second keyboard layout
    - Name your device: **windows11-lan-ready**
    - Select **Set up for personal use** (feel free to experiment)
    - Disconnect from the Internet and start over
      - Option 1 - power down the voyos router for a while
      - Option 2 - edit the VM's network device and check Disconnect for now; uncheck it later
    - Shift-F10 to open a shell
      - enter `OOBE\BYPASSNRO`
      - It will reboot the system and restart the installation wizard
    - At *Let's connect you to a network*
      - Click **I don't have internet**
    - Click **Continue with limited setup**
    - User: **lab**
    - Password: *select a password*
    - Create security questions for this account: be creative
    - Privacy: *disable all the settings* and then click **Next** (or might be Accept)
- Log in
- Reconnect to the Internet
- Apply Windows Updates (reboots included)
- Enable Remote Desktop (RDP)
  - Start > Settings > System > Remote Desktop
  - Slide to enable and Confirm
- Open the Edge web browser
    - At the screen "Browse the web with the best performing browser on Windows"
      - Click **Continue**
      - Click **Start without your data**
      - <ins>Uncheck</ins> Bring over your data and **Confirm and continue**
      - Click **Continue without this data**
      - <ins>Uncheck</ins> Make your Microsoft experience more useful and **Confirm and start browsing**
      - Click **Finish**
- [Install QEMU Guest Agent](Appendix_Install_Guest_Agent_Windows.md)
- Change the hostname to win-11-lan-ready
  - From administrative powershell: `Rename-Computer -NewName win11-lan-ready`
- Shut down the Windows VM
  - `stop-computer`
- Convert to a Template
  - Click on the VM
  - Click **More** > **Convert to template** (next to start, shutdown, and console)
    - Click **Yes**
    - Note that the VM is still there, but as a template it <ins>can only be cloned</ins>
- Clone a new VM from `win11-lan-ready`
  - Click on 109 (win11-lan-ready)
  - Click More > Clone
    - Target node: **proxmox-lab**
    - VM ID: *automatically populated** (up to 110)
    - Mode: **Linked Clone** is recommeded (saves space across all the clones)
      - the other option is Full Clone
    - Name: `win11-desk`
    - Click **Clone**
- Power on and test the new clone VM 1110 (win11-desk)
  - Click on the new VM **win11-desk**
  - Click **Start**
  - Click **Console**
  - Change the hostname to win11-desk
    - From administrative powershell: `Rename-Computer -NewName win11-desk`
    - `Restart-Computer`
- Optionally create another VM from each win11-lan and win11-lan-ready and experiment

# Windows 2022 Server
This is a bare-bones server with limited resources. Have seen Server 2019 run on 1GB RAM.

See also https://www.youtube.com/watch?v=XWvXXGL7Yl4

https://fedorapeople.org/groups/virt/virtio-win/direct-downloads/stable-virtio/virtio-win.iso

- From the top ribbon click **Create VM**
  - General tab
    - Node: **proxmox-lab**
    - VM ID: *auto populates* (unique ID required for every resource) (up to 111)
    - Name: **server2022-lan**
  - OS tab
    - Storage: *select one of the ISO storage units you created*
    - ISO image: *search and/or select the Windows 2022 Serer Eval ISO from dropdown*
    - Guest OS:
      - Type: **Microsoft Windows**
      - Version: **11/2022/2025**
  - System tab
    - No TPM or EFI disk requried
  - Disks tab
    - Disk size: **128GB**
    - Bus/Device defaults to IDE; feel free to experiment with this
    - Check **Discard** because our host uses SSDs
  - CPU tab
    - Sockets: 1
    - Cores: 1
    - Type: default (my Lab is x86-64-v2-AES)
  - Memory tab
    - **2048 MB** (2GB)
  - Network tab
    - Bridge: **vmbr1**
  - Confirm tab
    - Check **Start after created**
    - Click **Finish**
- From the left menu navigate to the new VM
  - Datacenter > proxmox-lab > 111 (server2022-lan)
  - Click on the VM in the left menu
- Click the **Console** button along the top of the pane
  - a separate windows is opened
- You are prompted **Press any key to boot from CD or DVD....**
  - **press any key**
  - if you missed it, stop the VM, start again and try again at the console
- Open the console and follow the Install wizard per usual
  - Confirm Language, formats, and keyboard then Next
  - Click Install now
  - Select the OS to install: Windows Server 2022 Standard Edition Evaluation (Desktop Experience)
    - feel free to experiment
  - Check the box then Next
  - Click Custom: Install Windows only (advanced)
  - Accept the installation on Drive 0
- When the system boots to "Customize settings" and prompts to set the Administrator's password
  - Remove the installation media
    - Back in the main proxmox window, click on the VM, then click Hardware
    - Edit the CD/DVD Drive
      - Do not use any media
  - Shift-F10 to open command prompt
  - `shutdown /t 0 /s`
- Clone a new VM from `server2022-lan`
  - Click on the VM 111 (server2022-lan)
  - Click More > Clone
    - Target node: **proxmox-lab**
    - VM ID: *automatically populated** (up to 112)
    - NOTE There is no "Linked Clone" option
    - Name: `server2022-lan-ready`
    - Click **Clone**  
- Power on `server2022-lan-ready`
  - Once it boots, set password for Administrator
- Log in
  - Expand the noVNC menu on the left
  - The first icon "A" is for "extra keys"; click the "Ctrl-Alt-Delete button" at the bottom
  - Yes, allow the server to be discovered by other hosts on the network
- Apply Windows Updates (reboots included)
- Enable RDP
  - Start > Settings > System > Remote Desktop
  - Slide to Enable Remote Desktop then accept the message
- [Install QEMU Guest Agent](Appendix_Install_Guest_Agent_Windows.md)
- Change the hostname to server2022-lan-ready
  - From administrative powershell: `Rename-Computer -NewName server2022-lan-ready`
- Shut down the Windows VM `server2022-lan-ready`
  - `stop-computer`
- Clone a new VM from `server2022-lan-ready`
  - We are preparing a Server 2022 image suitable for cloning
  - must perform generalization to remove the security identifier (SID)
  - Click on the VM 112 (server2022-lan-ready) (it should still be powered off)
  - Click **More** > **Clone**
    - Target node: **proxmox-lab**
    - VM ID: *automatically populated** (up to 113)
    - NOTE There is no "Linked Clone" option
    - Name: `server2022-lan-prep`
    - Click **Clone**  
- Power on VM 113 (server2022-lan-prep)
  - Open the console to server2022-lan-prep and log in
    - Open an administrative CMD or powershell window
    - `cmd /k %WINDIR%\System32\sysprep\sysprep.exe /oobe /generalize /shutdown`
- Convert to a Template
  - Click on the VM 113 (server2022-lan-prep)
  - Click **More** > **Convert to template** (next to start, shutdown, and console)
    - Click **Yes**
    - Note that the VM is still there, but as a template it <ins>can only be cloned</ins>
  - From now on, clone Windows Server VMs from `server2022-lan-prep`
- Questions to ponder:
  - What are the differences between the three Windows server clone images?
  - Does this affect the 180-day evaluation timer?
  - What are the advantages of each?
- Optionally clone VMs from each and experiment
  - How could you use Templates to quickly roll out a number of Windows servers with the same function or application? (e.g., a web server) When can this cause problems? (think SID)

Another NUC Lab (for XCP-ng) has details on
- Converting Windows Server to a Domain Controller
- Configuring a domain file server
- See https://github.com/doritoes/NUC-Labs/tree/main/XCP-ng

# Windows 2025 Server

# Confirm quemu Agents are Running
Verify from proxymox that the agents are running on your VMs
- Log in to proxmox web GUI and find the VM's ID (for example, 102)
- Log in to proxymox CLI and ping the VM's ID
  - `qm agent 102 ping`
- No message means it was successful, "QEMU guest agent is not running" means it is failing

If you are having issues
- 100 (vyos)
  - Confirm agent is running: `systemctl status qemu-guest-agent`
  - make sure Options > QEMU Guest Agent is enabled
  - completely power off and on the VM (not just restart)
